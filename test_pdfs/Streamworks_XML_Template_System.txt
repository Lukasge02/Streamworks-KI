STREAMWORKS XML TEMPLATE SYSTEM - TECHNISCHE DOKUMENTATION

=================================================================
ÜBERBLICK
=================================================================

Das Streamworks XML Template System generiert komplexe XML-Konfigurationen für
Job-Scheduling und Automatisierung. Es verwendet Jinja2-Templates zur dynamischen
XML-Erstellung basierend auf Benutzereingaben und Stream-Parametern.

=================================================================
TEMPLATE-STRUKTUR
=================================================================

1. TEMPLATE-TYPEN
   - sap_job_template.xml: SAP-spezifische Jobs mit jexa4S Integration
   - file_transfer_template.xml: Dateiübertragung zwischen Agenten
   - standard_job_template.xml: Allgemeine Skript-Ausführung

2. TEMPLATE-VARIABLEN
   - {{ variable_name }}: Direkte Substitution
   - {{ variable | default('fallback') }}: Mit Fallback-Wert
   - {% if condition %}: Bedingte Blöcke
   - {% for item in list %}: Schleifen für Arrays

3. XML-STRUKTUR HIERARCHIE
   ExportableStream
   └── Stream
       ├── StreamName
       ├── StreamDocumentation
       ├── AgentDetail
       ├── CalendarId
       ├── StreamType
       ├── MaxStreamRuns
       ├── ShortDescription
       └── Jobs
           ├── Job (StartPoint)
           ├── Job (Haupt-Job)
           └── Job (EndPoint)

=================================================================
SAP TEMPLATE DETAILS
=================================================================

STREAM-EBENE PARAMETER:
- stream_name: Eindeutige Stream-Bezeichnung
- agent_detail: Ausführungsagent (z.B. gtlnmiwvm1636)
- calendar_id: Scheduling-Kalender (Standard: UATDefaultCalendar)
- max_stream_runs: Parallele Ausführungen (Standard: 1)
- short_description: Kurzbeschreibung für Monitoring

SAP-SPEZIFISCHE PARAMETER:
- sap_system: SAP-System ID (z.B. PRD, QAS, ZTV)
- sap_client: SAP-Mandant (z.B. 100, 300)
- sap_user: SAP-Benutzername für Anmeldung
- sap_language: SAP-Sprache (Standard: DE)
- sap_transaction: Transaktion oder Report
- sap_report: Spezifischer Report-Name
- sap_variant: Report-Variante
- sap_output_format: Ausgabeformat (SPOOL, FILE, etc.)
- sap_output_path: Pfad für Ausgabedateien

JEXA4S INTEGRATION:
- Automatische Parameter-Übertragung
- Varianten-Management
- Output-Handling
- Fehlerbehandlung mit Retry-Logik

JOB-STRUKTUR:
1. StartPoint: Initialisierung ohne spezifische Aktionen
2. SAP Job: Hauptausführung mit SAP-Properties
3. EndPoint: Abschluss und Cleanup

BEISPIEL SAP-TEMPLATE FRAGMENT:
<JobSapProperty>
  <SapSystem>{{ sap_system | default('PA1_100') }}</SapSystem>
  <SapClient>{{ sap_client | default('100') }}</SapClient>
  <SapUser>{{ sap_user | default('SAP_USER') }}</SapUser>
  <SapLanguage>{{ sap_language | default('DE') }}</SapLanguage>
  {% if sap_report %}
  <SapReport>{{ sap_report }}</SapReport>
  {% endif %}
  {% if sap_parameters %}
  <SapParameters>
    {% for param_name, param_value in sap_parameters.items() %}
    <SapParameter>
      <ParameterName>{{ param_name }}</ParameterName>
      <ParameterValue>{{ param_value }}</ParameterValue>
    </SapParameter>
    {% endfor %}
  </SapParameters>
  {% endif %}
</JobSapProperty>

=================================================================
FILE TRANSFER TEMPLATE DETAILS
=================================================================

TRANSFER-PARAMETER:
- source_agent: Quell-Agent für Dateien
- target_agent: Ziel-Agent für Übertragung
- source_path: Quellverzeichnis (Windows/Linux Pfade)
- target_path: Zielverzeichnis
- transfer_method: COPY, FTP, SFTP, RSYNC, SCP
- file_pattern: Dateifilter (*.xml, *.csv, etc.)
- delete_source: Quelldateien nach Transfer löschen
- archive_mode: Archivierung aktivieren

PLATTFORM-UNTERSTÜTZUNG:
- Windows: UNC-Pfade, Laufwerksbuchstaben
- Linux: Absolute Pfade, Mount-Points
- Mixed Environments: Automatische Pfad-Konvertierung

SICHERHEITSASPEKTE:
- Verschlüsselte Übertragung (SFTP)
- Authentifizierung über Agent-Credentials
- Netzwerk-Segmentierung über DMZ-Agenten

BEISPIEL TRANSFER-KONFIGURATION:
<FileTransferJob>
  <SourceAgent>{{ source_agent }}</SourceAgent>
  <TargetAgent>{{ target_agent }}</TargetAgent>
  <SourcePath>{{ source_path }}</SourcePath>
  <TargetPath>{{ target_path }}</TargetPath>
  <TransferMethod>{{ transfer_method | default('COPY') }}</TransferMethod>
  <FilePattern>{{ file_pattern | default('*.*') }}</FilePattern>
  <DeleteSource>{{ delete_source | default(False) }}</DeleteSource>
  <ArchiveMode>{{ archive_mode | default(False) }}</ArchiveMode>
</FileTransferJob>

=================================================================
STANDARD TEMPLATE DETAILS
=================================================================

SCRIPT-PARAMETER:
- main_script: Hauptskript (Bash, Batch, Python, etc.)
- job_type: Plattform (Windows, Linux, Unix)
- working_directory: Arbeitsverzeichnis
- parameters: Kommandozeilen-Parameter
- environment_variables: Umgebungsvariablen
- timeout: Maximale Laufzeit in Minuten

SCRIPT-ARTEN:
- Batch-Dateien (.bat, .cmd)
- Shell-Skripte (.sh)
- Python-Skripte (.py)
- PowerShell-Skripte (.ps1)
- Ausführbare Programme (.exe)

FEHLERBEHANDLUNG:
- Exit-Code Auswertung
- Timeout-Management
- Retry-Mechanismen
- Logging und Monitoring

BEISPIEL STANDARD-JOB:
<MainScript><![CDATA[
{{ main_script | default('echo "Standard Job executed"') }}
]]></MainScript>
<JobType>{{ job_type | default('Windows') }}</JobType>
{% if working_directory %}
<WorkingDirectory>{{ working_directory }}</WorkingDirectory>
{% endif %}
{% if environment_variables %}
<EnvironmentVariables>
  {% for var_name, var_value in environment_variables.items() %}
  <EnvironmentVariable>
    <Name>{{ var_name }}</Name>
    <Value>{{ var_value }}</Value>
  </EnvironmentVariable>
  {% endfor %}
</EnvironmentVariables>
{% endif %}

=================================================================
SCHEDULING UND TIMING
=================================================================

KALENDER-INTEGRATION:
- UATDefaultCalendar: Standard-Testumgebung
- ProductionCalendar: Produktive Systeme
- MaintenanceCalendar: Wartungsfenster
- CustomCalendar: Benutzerdefinierte Zeiten

ZEITSTEUERUNG:
- StartTime: Absolute oder relative Startzeit
- StartTimeDayType: Normal, Holiday, Weekend
- LatestStartTime: Spätester Startzeitpunkt
- StartTimeOffsetDays: Tagesversatz

ABHÄNGIGKEITEN:
- JobInternalSuccessors: Job-Ketten
- ExternalDependencies: Externe Trigger
- FileDependency: Datei-basierte Abhängigkeiten
- LogicalResourceDependencies: Ressourcen-Locks

BEISPIEL SCHEDULING:
<StreamRunJobProperty>
  <RunNumber>0</RunNumber>
  {% if start_time %}
  <StartTime>{{ start_time }}</StartTime>
  <StartTimeDayType>{{ start_time_day_type | default('Normal') }}</StartTimeDayType>
  <StartTimeType>{{ start_time_type | default('Absolute') }}</StartTimeType>
  {% endif %}
  <MaxJobDuration>{{ timeout | default('') }}</MaxJobDuration>
</StreamRunJobProperty>

=================================================================
LOGGING UND MONITORING
=================================================================

LOG-KONFIGURATION:
- CentralJobLogFlag: Zentrale Log-Sammlung
- AgentJobLogStorageDays: Lokale Log-Aufbewahrung
- MaxJobLogSize: Maximale Log-Größe
- CentralJobLogStorageDays: Zentrale Aufbewahrung

MONITORING-PARAMETER:
- ReportToIncidentManagementFlag: Incident-Reporting
- Severity: Prioritätsstufe
- MaxJobDuration: Timeout-Überwachung
- MinJobDuration: Performance-Überwachung

BENACHRICHTIGUNGEN:
- JobNotificationRules: E-Mail/SMS bei Events
- JobContactPersons: Verantwortliche Personen
- IsNotificationRequired: Benachrichtigung aktiviert

=================================================================
TEMPLATE ENGINE IMPLEMENTIERUNG
=================================================================

PYTHON TEMPLATE ENGINE:
```python
from jinja2 import Environment, FileSystemLoader
import json

class XMLTemplateEngine:
    def __init__(self, template_dir='templates/xml_templates'):
        self.env = Environment(
            loader=FileSystemLoader(template_dir),
            trim_blocks=True,
            lstrip_blocks=True
        )

    def generate_xml(self, template_name, parameters):
        template = self.env.get_template(template_name)

        # Template-Variablen erweitern
        template_vars = {
            **parameters,
            'timestamp': datetime.now().strftime('%Y%m%d_%H%M%S'),
            'date': datetime.now().strftime('%Y%m%d'),
            'generated_at': datetime.now().isoformat()
        }

        return template.render(**template_vars)
```

TEMPLATE-AUSWAHL:
- Stream-Typ bestimmt Template
- Parameter-Validation vor Rendering
- Default-Werte für fehlende Parameter
- Error-Handling bei Template-Fehlern

XML-VALIDATION:
- Schema-Validation gegen XSD
- Syntax-Prüfung für CDATA-Sections
- Parameter-Konsistenz-Checks
- Output-Formatting und Pretty-Print

=================================================================
ERROR HANDLING UND DEBUGGING
=================================================================

HÄUFIGE TEMPLATE-FEHLER:
1. Fehlende Required-Parameter
2. Ungültige Jinja2-Syntax
3. CDATA-Escape-Probleme
4. Encoding-Issues (UTF-8)

DEBUGGING-STRATEGIEN:
- Template-Variablen loggen
- Schritt-für-Schritt Rendering
- Validation gegen bekannte Schemas
- Unit-Tests für Template-Logik

FALLBACK-MECHANISMEN:
- Default-Werte für alle Parameter
- Template-Auswahl bei Fehlern
- Graceful Degradation
- Error-Templates für Debugging

=================================================================
PERFORMANCE UND OPTIMIERUNG
=================================================================

TEMPLATE-CACHING:
- Compiled Templates im Memory
- Parameter-basiertes Caching
- Invalidierung bei Template-Änderungen

RENDERING-OPTIMIERUNG:
- Lazy Loading für große Templates
- Parallel Processing für Bulk-Generierung
- Memory-Management bei großen XMLs

SKALIERUNG:
- Template-Versionierung
- Multi-Tenant Template-Isolation
- Distributed Template-Rendering

Diese Dokumentation bietet eine vollständige Übersicht über das
Streamworks XML Template System und dient als Referenz für
Entwicklung, Konfiguration und Troubleshooting.